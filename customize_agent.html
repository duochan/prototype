<!DOCTYPE html>
<html lang="zh-CN" class="">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>探域科技 - 自定义Agent</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet"/>
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
    
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#1677ff", // Brand Blue
                        "primary-hover": "#4096ff",
                        "background-light": "#f5f5f5",
                        "background-dark": "#121212",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1e1e1e",
                        "border-light": "#e5e7eb",
                        "border-dark": "#333333",
                        "text-primary-light": "#1f1f1f",
                        "text-primary-dark": "#e5e5e5",
                        "text-secondary-light": "#6b7280",
                        "text-secondary-dark": "#9ca3af",
                    },
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans SC"', 'sans-serif'],
                    },
                    boxShadow: {
                        'modal': '0 4px 12px rgba(0, 0, 0, 0.15)',
                        'card-hover': '0 4px 10px rgba(0, 0, 0, 0.1)',
                        'dropdown': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                    }
                },
            },
        };
    </script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4b5563;
        }
        
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Dropdown Animation */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.2s ease-out forwards;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-text-primary-light dark:text-text-primary-dark font-sans transition-colors duration-200 antialiased h-screen overflow-hidden flex">

    <!-- Global Sidebar (From Tool Management) -->
    <aside class="w-64 bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark flex-shrink-0 flex flex-col h-full overflow-y-auto z-20">
        <!-- Logo Area -->
        <div class="h-16 flex items-center px-4 border-b border-border-light dark:border-border-dark sticky top-0 bg-surface-light dark:bg-surface-dark z-20">
            <div class="flex items-center space-x-2 text-primary font-bold text-xl cursor-pointer" onclick="toggleDarkMode()" title="点击切换深色模式">
                <span class="material-icons-outlined">science</span>
                <span>探域科技</span>
            </div>
            <div class="ml-auto bg-blue-50 dark:bg-blue-900/30 text-primary text-xs px-2 py-0.5 rounded flex items-center gap-1 cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors">
                <span class="material-icons-outlined text-sm">cloud</span>
                <span>智能体</span>
                <span class="material-icons-outlined text-sm rotate-180">logout</span>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 py-4 space-y-1">
            <a class="flex items-center px-4 py-2 text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors group" href="#">
                <span class="material-icons-outlined mr-3 text-lg">home</span>
                <span class="text-sm">首页</span>
            </a>

            <!-- Dropdown Menu Item (Expanded) -->
            <div>
                <button class="w-full flex items-center justify-between px-4 py-2 text-primary bg-blue-50 dark:bg-blue-900/20 dark:text-primary transition-colors">
                    <div class="flex items-center">
                        <span class="material-icons-outlined mr-3 text-lg">support_agent</span>
                        <span class="text-sm font-medium">客服Agent</span>
                    </div>
                    <span class="material-icons-outlined text-sm">expand_more</span>
                </button>
                <div class="pl-12 py-1 space-y-1">
                    <a class="block py-2 text-sm text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors" href="#">基础配置</a>
                    <a class="block py-2 text-sm text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors" href="#">记忆库</a>
                    
                    <!-- Active Sub-item: Custom Agent -->
                    <a class="block py-2 text-sm text-primary font-medium bg-blue-50 dark:bg-blue-900/20 rounded-l-md -mr-4 pl-4 border-r-2 border-primary relative" href="#">
                        自定义Agent
                    </a>
                    
                    <a class="block py-2 text-sm text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors" href="skill.html">技能</a>
                </div>
            </div>

            <a class="flex items-center px-4 py-2 text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" href="#">
                <span class="material-icons-outlined mr-3 text-lg">menu_book</span>
                <span class="text-sm">知识中心</span>
                <span class="material-icons-outlined ml-auto text-sm text-gray-400">chevron_right</span>
            </a>
            <a class="flex items-center px-4 py-2 text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" href="#">
                <span class="material-icons-outlined mr-3 text-lg">analytics</span>
                <span class="text-sm">诊断优化</span>
                <span class="material-icons-outlined ml-auto text-sm text-gray-400">chevron_right</span>
            </a>
            <a class="flex items-center px-4 py-2 text-text-secondary-light dark:text-text-secondary-dark hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors" href="#">
                <span class="material-icons-outlined mr-3 text-lg">people</span>
                <span class="text-sm">子帐号列表</span>
            </a>
        </nav>
    </aside>

    <!-- Main Application Area (Flex Container) -->
    <div class="flex-1 flex flex-col min-w-0 bg-background-light dark:bg-background-dark overflow-hidden relative">
        
        <!-- Top Header (From Tool Management) -->
        <header class="h-16 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark flex items-center justify-between px-6 z-20 flex-shrink-0">
            <!-- Breadcrumbs -->
            <div class="flex items-center text-text-secondary-light dark:text-text-secondary-dark text-sm">
                <span>客服Agent</span>
                <span class="material-icons-outlined text-sm mx-2">chevron_right</span>
                <span class="text-text-primary-light dark:text-text-primary-dark font-medium">自定义Agent</span>
            </div>

            <!-- Header Actions -->
            <div class="flex items-center space-x-6 text-sm">
                <button class="flex items-center text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors">
                    <span class="material-icons-outlined mr-1 text-lg">diamond</span>
                    套餐资源
                    <span class="material-icons-outlined text-xs ml-1">expand_more</span>
                </button>
                <button class="flex items-center text-text-secondary-light dark:text-text-secondary-dark hover:text-primary transition-colors">
                    <span class="material-icons-outlined mr-1 text-lg">download</span>
                    客户端(v2.1.0)
                </button>
                <div class="flex items-center cursor-pointer group">
                    <div class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-primary font-bold mr-2 border border-blue-200 dark:border-blue-800">
                        <span class="material-icons-outlined text-sm">person</span>
                    </div>
                    <span class="text-text-primary-light dark:text-text-primary-dark group-hover:text-primary transition-colors">陈伟佳Vega</span>
                    <span class="material-icons-outlined text-xs ml-1 text-text-secondary-light">expand_more</span>
                </div>
            </div>
        </header>

        <!-- Inner Content Area (Flex Row for 3 Columns) -->
        <div class="flex flex-1 overflow-hidden">
            
            <!-- Column 1: Agent List Sidebar -->
            <aside class="w-80 bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark flex flex-col shrink-0 overflow-y-auto hide-scrollbar p-4 space-y-4 z-10">
                <div class="bg-primary hover:bg-primary-hover text-white p-5 rounded-lg cursor-pointer transition-colors shadow-sm">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-lg">创建自定义 Agent</h3>
                        <span class="material-icons-outlined text-2xl">add_circle_outline</span>
                    </div>
                    <p class="text-sm text-blue-100 leading-relaxed">根据您的使用场景需求，快速搭建专属Agent。</p>
                </div>

                <!-- Agent Item: ql -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">ql</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 1</span>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">草稿</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                            <div class="flex items-center space-x-1 px-2 py-1 bg-white dark:bg-gray-700 rounded-l-full rounded-r-full border border-gray-200 dark:border-gray-600 opacity-60">
                                <span class="text-xs font-medium">正式</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-gray-300"></div>
                            </div>
                        </div>
                        <div class="flex space-x-2 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-icons-outlined text-lg hover:text-primary">settings</span>
                            <span class="material-icons-outlined text-lg hover:text-red-500">delete</span>
                        </div>
                    </div>
                </div>

                <!-- Agent Item: Sivantest -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">Sivantest</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 1</span>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">草稿</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">正式</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                        </div>
                        <div class="flex space-x-2 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-icons-outlined text-lg hover:text-primary">settings</span>
                            <span class="material-icons-outlined text-lg hover:text-red-500">delete</span>
                        </div>
                    </div>
                </div>

                <!-- Agent Item: 墨镜勿删 -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">墨镜删</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 32</span>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">草稿</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">正式</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                        </div>
                        <div class="flex space-x-2 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-icons-outlined text-lg hover:text-primary">settings</span>
                            <span class="material-icons-outlined text-lg hover:text-red-500">delete</span>
                        </div>
                    </div>
                </div>

                <!-- Agent Item: 11111111 -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">11111111</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 1</span>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">草稿</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">正式</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                        </div>
                        <div class="flex space-x-2 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-icons-outlined text-lg hover:text-primary">settings</span>
                            <span class="material-icons-outlined text-lg hover:text-red-500">delete</span>
                        </div>
                    </div>
                </div>

                <!-- Agent Item: 鱼竿推荐 -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">鱼竿推荐</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 1</span>
                    <div class="flex items-center justify-between mt-2">
                        <div class="flex items-center space-x-2">
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">草稿</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                            <div class="flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-l-full rounded-r-full border border-blue-100 dark:border-blue-800">
                                <span class="text-xs font-medium text-primary dark:text-blue-400">正式</span>
                                <div class="w-2 h-2 rounded-full bg-white border-2 border-primary"></div>
                            </div>
                        </div>
                        <div class="flex space-x-2 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span class="material-icons-outlined text-lg hover:text-primary">settings</span>
                            <span class="material-icons-outlined text-lg hover:text-red-500">delete</span>
                        </div>
                    </div>
                </div>

                <!-- Agent Item: 售后破损回复流程 -->
                <div class="bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer relative group mb-8">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium text-text-primary-light dark:text-text-primary-dark">售后破损回复流程（挂锋）</h4>
                    </div>
                    <span class="inline-block px-2 py-0.5 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 text-xs rounded mb-3">店铺 1</span>
                </div>
            </aside>

            <!-- Column 2: Editor Main Area -->
            <section class="flex-1 overflow-y-auto p-6 flex flex-col relative bg-surface-light dark:bg-background-dark">
                <!-- Toolbar -->
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center bg-gray-100 dark:bg-gray-800 p-1 rounded-lg">
                        <button class="px-4 py-1.5 bg-white dark:bg-gray-700 shadow-sm rounded-md text-sm font-medium text-text-primary-light dark:text-text-primary-dark">草稿版本</button>
                        <button class="px-4 py-1.5 text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark hover:text-text-primary-light dark:hover:text-text-primary-dark transition-colors">正式版本</button>
                    </div>
                    <button class="flex items-center space-x-1 px-4 py-2 bg-primary hover:bg-primary-hover text-white rounded-md text-sm shadow-sm transition-colors">
                        <span class="material-icons-outlined text-base">send</span>
                        <span>发布</span>
                    </button>
                </div>
                
                <div class="text-xs text-text-secondary-light dark:text-text-secondary-dark mb-4">
                    已自动保存: 2025-12-24 12:03:48
                </div>

                <!-- Editor Form -->
                <div class="space-y-4">
                    <!-- Trigger Scene -->
                    <div class="bg-blue-50/50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30 rounded-lg p-4">
                        <h3 class="font-medium text-text-primary-light dark:text-text-primary-dark mb-2 text-sm">触发场景描述</h3>
                        <div class="w-full bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded p-3 text-sm text-text-primary-light dark:text-text-primary-dark min-h-[60px] focus-within:ring-2 focus-within:ring-primary focus-within:border-transparent" contenteditable="true">
                            当用户询问情侣T恤的尺码选择、推荐或匹配问题时
                        </div>
                    </div>

                    <!-- Prompt Editor -->
                    <div id="promptContainer" class="bg-blue-50/50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-900/30 rounded-lg p-4 flex flex-col gap-2">
                        <h3 class="font-medium text-text-primary-light dark:text-text-primary-dark mb-2 text-sm">提示词</h3>
                        <div class="relative">
                            <textarea id="promptTextarea" rows="3" oninput="autoResizePrompt(this); handlePromptInput(this)" class="w-full bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded p-3 text-sm text-text-primary-light dark:text-text-primary-dark resize-none focus:ring-2 focus:ring-primary focus:border-transparent placeholder-gray-400 outline-none overflow-hidden min-h-[96px]" placeholder="请输入 @ 引用已配置的记忆或工具"></textarea>
                            
                            <!-- Dropdown Menu (Hidden initially) -->
                            <div id="mentionDropdown" class="hidden absolute z-50 w-64 bg-white dark:bg-gray-800 rounded-md shadow-dropdown border border-border-light dark:border-border-dark overflow-hidden animate-fade-in-up" style="top: 40px; left: 12px;">
                                <div class="py-1 max-h-60 overflow-y-auto" id="mentionDropdownList">
                                    <!-- Dynamic items -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Column 3: Resources Sidebar (Memories/Knowledge) -->
            <aside class="w-80 bg-surface-light dark:bg-surface-dark border-l border-border-light dark:border-border-dark flex flex-col shrink-0 overflow-y-auto p-4 z-10 space-y-8">
                <!-- Memories Section -->
                <div>
                    <h3 class="font-medium text-text-primary-light dark:text-text-primary-dark mb-4">可用记忆</h3>
                    <div class="relative mb-3">
                        <select class="w-full pl-3 pr-10 py-2 text-sm bg-white dark:bg-gray-800 border border-border-light dark:border-border-dark rounded hover:border-gray-400 focus:outline-none focus:ring-1 focus:ring-primary appearance-none text-text-secondary-light dark:text-text-secondary-dark">
                            <option>选择记忆标签分组</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500">
                            <span class="material-icons-outlined text-lg">expand_more</span>
                        </div>
                    </div>
                    <button class="w-full border border-dashed border-border-light dark:border-gray-600 text-text-secondary-light dark:text-text-secondary-dark hover:border-primary hover:text-primary dark:hover:text-primary-hover rounded py-2 text-sm flex items-center justify-center transition-colors bg-white dark:bg-transparent">
                        <span class="material-icons-outlined text-base mr-1">add</span>
                        新建记忆标签
                    </button>
                </div>

                <!-- Knowledge Tables Section -->
                <div>
                    <h3 class="font-medium text-text-primary-light dark:text-text-primary-dark mb-4">可用表格知识</h3>
                    <div class="flex items-center space-x-2 mb-4">
                        <button class="flex-1 border border-dashed border-border-light dark:border-gray-600 text-text-secondary-light dark:text-text-secondary-dark hover:border-primary hover:text-primary dark:hover:text-primary-hover rounded py-1.5 text-xs flex items-center justify-center transition-colors bg-white dark:bg-transparent">
                            <span class="material-icons-outlined text-sm mr-1">add</span>
                            新建表格知识
                        </button>
                        <span class="knowledge-item px-2 py-1.5 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-default">情侣款T恤推荐表</span>
                    </div>
                    
                    <div id="knowledgeList" class="flex flex-wrap gap-2">
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">鼠标键盘查询</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">情侣款T恤属性表</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">墨镜参数类型</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">测试1</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">视频</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">泳裤</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">手表推荐</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">测试</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">鱼竿推荐</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">加湿器推荐</span>
                        <span class="knowledge-item px-2 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded border border-green-100 dark:border-green-800 cursor-pointer hover:bg-green-100 transition-colors">空调属性表格</span>
                    </div>
                </div>

                <!-- Tool Sets Section (New) -->
                <div>
                    <h3 class="font-medium text-text-primary-light dark:text-text-primary-dark mb-4">可用技能</h3>
                    <div class="flex items-center space-x-2 mb-4">
                        <button class="flex-1 border border-dashed border-border-light dark:border-gray-600 text-text-secondary-light dark:text-text-secondary-dark hover:border-primary hover:text-primary dark:hover:text-primary-hover rounded py-1.5 text-xs flex items-center justify-center transition-colors bg-white dark:bg-transparent">
                            <span class="material-icons-outlined text-sm mr-1">add</span>
                            新建技能
                        </button>
                    </div>
                    
                    <div id="toolSetList" class="flex flex-wrap gap-2">
                        <!-- Custom Quote Calculator Tag -->
                        <span class="tool-item px-2 py-1 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded border border-orange-100 dark:border-orange-800 cursor-pointer hover:bg-orange-100 transition-colors">定制报价计算器</span>
                        <span class="tool-item px-2 py-1 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded border border-orange-100 dark:border-orange-800 cursor-pointer hover:bg-orange-100 transition-colors">物流查询</span>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Floating Quick Actions -->
        <div class="fixed bottom-6 right-6 flex flex-col space-y-3 z-50">
            <button class="w-12 h-12 bg-white dark:bg-gray-800 text-text-secondary-light dark:text-text-secondary-dark rounded-full shadow-lg flex items-center justify-center hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-border-light dark:border-gray-600">
                <span class="material-icons-outlined">article</span>
            </button>
            <button class="w-12 h-12 bg-primary rounded-full shadow-lg flex items-center justify-center text-white hover:bg-primary-hover transition-transform hover:scale-110 shadow-blue-500/30">
                <span class="material-icons-outlined text-2xl">smart_toy</span>
            </button>
        </div>

    </div>

    <script>
        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
        }

        // Auto-resize prompt textarea to fit content and keep the blue container height in sync
        function autoResizePrompt(textarea) {
            if (!textarea) return;
            textarea.style.height = 'auto';
            textarea.style.height = `${textarea.scrollHeight}px`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const promptTextarea = document.getElementById('promptTextarea');
            autoResizePrompt(promptTextarea);
        });

        // Logic for @ Mention Interaction
        function handlePromptInput(textarea) {
            const cursorPosition = textarea.selectionStart;
            const text = textarea.value;
            const lastChar = text.substring(cursorPosition - 1, cursorPosition);
            
            if (lastChar === '@') {
                showMentionDropdown(textarea);
            } else {
                // Optional: Hide dropdown if user deletes @ or continues typing without selecting
                // For simplicity in this demo, we hide on click outside
            }
        }

        function collectMentionData() {
            const items = [];
            
            // Collect Knowledge Tables (Green)
            document.querySelectorAll('.knowledge-item').forEach(el => {
                items.push({ 
                    name: el.innerText, 
                    type: '表格知识',
                    class: 'text-green-600 bg-green-50 border-green-100'
                });
            });

            // Collect Tool Sets (Orange)
            document.querySelectorAll('.tool-item').forEach(el => {
                items.push({ 
                    name: el.innerText, 
                    type: '技能',
                    class: 'text-orange-600 bg-orange-50 border-orange-100'
                });
            });

            return items;
        }

        function showMentionDropdown(textarea) {
            const dropdown = document.getElementById('mentionDropdown');
            const list = document.getElementById('mentionDropdownList');
            list.innerHTML = ''; // Clear previous

            const data = collectMentionData();

            if (data.length === 0) {
                 const emptyItem = document.createElement('div');
                 emptyItem.className = "px-4 py-2 text-xs text-text-secondary-light";
                 emptyItem.innerText = "无可用引用内容";
                 list.appendChild(emptyItem);
            } else {
                data.forEach(item => {
                    const el = document.createElement('div');
                    el.className = "px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer flex justify-between items-center group transition-colors";
                    el.onclick = () => insertMention(item.name);
                    
                    const nameSpan = document.createElement('span');
                    nameSpan.className = "text-sm text-text-primary-light dark:text-text-primary-dark font-medium";
                    nameSpan.innerText = item.name;

                    const typeSpan = document.createElement('span');
                    // Use generic styling for the label in dropdown for consistency
                    typeSpan.className = "text-[10px] px-1.5 py-0.5 rounded ml-2 border opacity-80 " + (item.type === '表格知识' ? 'bg-green-50 text-green-600 border-green-200' : 'bg-orange-50 text-orange-600 border-orange-200');
                    typeSpan.innerText = item.type;

                    const container = document.createElement('div');
                    container.className = "flex items-center";
                    container.appendChild(nameSpan);
                    
                    el.appendChild(container);
                    el.appendChild(typeSpan);
                    list.appendChild(el);
                });
            }

            dropdown.classList.remove('hidden');
            
            // Auto hide on click outside
            const hideDropdown = (e) => {
                if (!dropdown.contains(e.target) && e.target !== textarea) {
                    dropdown.classList.add('hidden');
                    document.removeEventListener('click', hideDropdown);
                }
            };
            document.addEventListener('click', hideDropdown);
        }

        function insertMention(name) {
            const textarea = document.getElementById('promptTextarea');
            const cursorPosition = textarea.selectionStart;
            const currentValue = textarea.value;
            
            // Find the @ before cursor to replace (simple version just appends after @)
            const before = currentValue.substring(0, cursorPosition);
            const after = currentValue.substring(cursorPosition);
            
            // Insert name + space
            const newValue = before + name + " " + after;
            
            textarea.value = newValue;
            autoResizePrompt(textarea);
            textarea.focus();
            
            // Move cursor
            const newCursorPos = cursorPosition + name.length + 1;
            textarea.setSelectionRange(newCursorPos, newCursorPos);

            document.getElementById('mentionDropdown').classList.add('hidden');
        }
    </script>
</body>
</html>